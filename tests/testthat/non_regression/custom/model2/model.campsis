[MAIN]
if (newind != 2) MY_AST=AST
CLAST=(pow((MY_AST/40), THETA_CLAST))
CLCOV=CLAST
BIOBBILTOT=(pow((BBILTOT/0.8), THETA_BIOBBILTOT))
BIOAST=(pow((MY_AST/40), THETA_BIOAST))
BIOCOV=BIOAST * BIOBBILTOT
TVBIO=THETA_BIO
TVBIO_=BIOCOV * TVBIO
TVLAG=THETA_LAG
TVKA=THETA_KA
TVCLMAX=THETA_CLMAX
TVVC=THETA_VC
TVT50=THETA_T50
GAM=THETA_GAM
ADDRUV=THETA_ADDRUV
PROPRUV=THETA_PROPRUV
BIO=TVBIO_ * exp(ETA_BIO)
LAG=TVLAG * exp(ETA_LAG)
KA=TVKA * exp(ETA_KA)
CLMAX=TVCLMAX
T50=TVT50 * exp(ETA_T50)
VC=TVVC * exp(ETA_VC) * pow((BWT/70), 1)
F_A1=BIO
LAG_A1=LAG
V=VC
SCALE2=VC
MY_AST=AST

[ODE]
TVCL=0.001 + CLMAX * pow((t + TXREF), GAM)/(pow((t + TXREF), GAM) + pow(T50, GAM))
CL=TVCL * CLCOV * exp(ETA_CL) * pow((BWT/70), 0.75)
KE=CL/VC
d/dt(A_DEPOT)=-KA * A_DEPOT
d/dt(A_CENTRAL)=KA * A_DEPOT - KE * A_CENTRAL
F=A_CENTRAL/SCALE2

[F]
A_DEPOT=F_A1

[LAG]
A_DEPOT=LAG_A1

[ERROR]
IPRED=F
IPRED_err=IPRED + sqrt(pow(THETA_ADDRUV, 2) + pow(THETA_PROPRUV, 2) * pow(IPRED, 2)) * EPS_FIX1

