[MAIN]
if (NEWIND != 2) MY_AST=AST
CLAST=pow((1.0/40.0)*MY_AST, THETA_CLAST)
CLCOV=CLAST
BIOBBILTOT=pow(1.25*BBILTOT, THETA_BIOBBILTOT)
BIOAST=pow((1.0/40.0)*MY_AST, THETA_BIOAST)
BIOCOV=BIOAST*BIOBBILTOT
TVBIO=THETA_BIO
TVBIO_=BIOCOV*TVBIO
TVLAG=THETA_LAG
TVKA=THETA_KA
TVCLMAX=THETA_CLMAX
TVVC=THETA_VC
TVT50=THETA_T50
GAM=THETA_GAM
ADDRUV=THETA_ADDRUV
PROPRUV=THETA_PROPRUV
BIO=TVBIO_*exp(ETA_BIO)
LAG=TVLAG*exp(ETA_LAG)
KA=TVKA*exp(ETA_KA)
CLMAX=TVCLMAX
T50=TVT50*exp(ETA_T50)
VC=(1.0/70.0)*BWT*TVVC*exp(ETA_VC)
F1=BIO
ALAG1=LAG
V=VC
S2=VC
MY_AST=AST

[ODE]
TVCL=CLMAX*pow(t + TXREF, GAM)/(pow(T50, GAM) + pow(t + TXREF, GAM)) + 0.001
CL=0.041321537264558256*pow(BWT, 0.75)*CLCOV*TVCL*exp(ETA_CL)
KE=CL/VC
d/dt(A_DEPOT)=-A(DEPOT)*KA
d/dt(A_CENTRAL)=-A(CENTRAL)*KE + A(DEPOT)*KA

[F]
A_DEPOT=F1

[LAG]
A_DEPOT=ALAG1

[ERROR]
IPRED=F
W=sqrt(pow(ADDRUV, 2) + pow(IPRED, 2)*pow(PROPRUV, 2))
Y=EPS_RSV_FIX*W + IPRED
IRES=DV - IPRED
IWRES=IRES/W

