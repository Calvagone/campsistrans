[MAIN]
TVX0=THETA_X0
TVXSS=THETA_XSS
TVREP=THETA_REP
BSVX0=ETA_BSVX0
BSVXSS=ETA_BSVXSS
BSVREP=ETA_BSVREP
SHPX0=THETA_SHPX0
PHIX0=exp(BSVX0)
PHI2X0=(pow(PHIX0, SHPX0) - 1)/SHPX0
SHPXSS=THETA_SHPXSS
PHIXSS=exp(BSVXSS)
PHI2XSS=(pow(PHIXSS, SHPXSS) - 1)/SHPXSS
X0=TVX0*exp(PHI2X0)
XSS=TVXSS*exp(PHI2XSS)
REP=TVREP*exp(BSVREP)
HL=M_LN2/REP
TVWT0=THETA_WT0
TVWT120=THETA_WT120
BSVWT0=ETA_BSVWT0
BSVWT120=ETA_BSVWT120
SHPWT120=THETA_SHPWT120
PHIWT120=exp(BSVWT120)
PHI2WT120=(pow(PHIWT120, SHPWT120) - 1)/SHPWT120
WT0=TVWT0*exp(BSVWT0)
WT120=TVWT120*exp(PHI2WT120)
SLOPE=-1.0/20160.0*WT0 + (1.0/20160.0)*WT120
TVMAT=THETA_MAT
TVFR=THETA_FR
TVCL=THETA_CL
TVV=THETA_V
TVQ1=THETA_Q1
TVVP1=THETA_VP1
TVQ2=THETA_Q2
TVVP2=THETA_VP2
TVCLM2=THETA_CLM2
TVVM2=THETA_VM2
BOVF=ETA_BOVF
if (OCC == 2) BOVF=ETA(7)
BOVMAT=ETA_BOVMAT
if (OCC == 2) BOVMAT=ETA(9)
BSVF=ETA_BSVF
BSVCL=ETA_BSVCL
BSVCLM2=ETA_BSVCLM2
BSVV=ETA_BSVV
BSVQ1=ETA_BSVQ1
BSVVM2=ETA_BSVVM2
BLACK=0
if (RACE == 2) BLACK=1
BLACKCL=BLACK*THETA_BLACKCL + 1
AGECL=THETA_AGECL*(32 - AGE) + 1
PHI=BOVMAT + log(TVMAT/(1 - TVMAT))
MAT=6*exp(PHI)/(exp(PHI) + 1)
FR=TVFR
MTT=FR*MAT
KAHL=0.30303030303030304*MAT*(1 - FR)
KA=M_LN2/KAHL
KTR=2/MTT
F1=1.8002*exp(BOVF + BSVF)
CLB=AGECL*BLACKCL*TVCL*exp(BSVCL)
VB=TVV*exp(BSVV)
Q1B=TVQ1*exp(BSVQ1)
VP1B=TVVP1
Q2B=TVQ2
VP2B=TVVP2
CLM2B=AGECL*BLACKCL*TVCLM2*exp(BSVCLM2)
VM2B=TVVM2*exp(BSVVM2)

[ODE]
d/dt(A_8)=(1.0/168.0)*A_8*(-A_8/XSS + 1)*M_LN2/HL
WTTIME=SLOPE*t + WT0
ALBRELI=A_8/XSS
COVALBI=pow(ALBRELI, THETA_FME)
FM=pow(ALBRELI, -THETA_FME)
ALLCL=pow((1.0/70.0)*WTTIME, THETA_ALLCLE)
ALLV=pow((1.0/70.0)*WTTIME, THETA_ALLVE)
CL=ALLCL*CLB*COVALBI
V=ALLV*VB
Q1=ALLCL*Q1B
VP1=ALLV*VP1B
Q2=ALLCL*Q2B
VP2=ALLV*VP2B
CLM2=ALLCL*CLM2B*COVALBI/FM
VM2=ALLV*VM2B/FM
d/dt(A_1)=-A_1*KTR
d/dt(A_2)=-A_2*CL/V - A_2*Q1/V - A_2*Q2/V + A_3*Q1/VP1 + A_4*Q2/VP2 + A_7*KA
d/dt(A_3)=A_2*Q1/V - A_3*Q1/VP1
d/dt(A_4)=A_2*Q2/V - A_4*Q2/VP2
d/dt(A_5)=A_2*CL/V - A_5*CLM2/VM2
d/dt(A_6)=A_1*KTR - A_6*KTR
d/dt(A_7)=A_6*KTR - A_7*KA

[F]
A_8=F1

[INIT]
A_7=X0

[ERROR]
WTTIMEE=SLOPE*TIME + WT0
FURELIP=THETA_XSS/A_8
COVFUIP=pow(FURELIP, THETA_COVFUIP)
ALBRELIE=A_8/XSS
FME=pow(ALBRELIE, -THETA_FME)
ALLCLE=pow((1.0/70.0)*WTTIMEE, THETA_ALLCLE)
ALLVE=pow((1.0/70.0)*WTTIMEE, THETA_ALLVE)
VE=ALLVE*COVFUIP*VB
VM2E=ALLVE*COVFUIP*VM2B/FME
DEL=9.9999999999999998e-13
IPRED=log(A_2/VE + DEL)
if (FLAG == 2) IPRED=log(A_5/VM2E + DEL)
if (FLAG == 3) IPRED=A_8
if (FLAG == 4) IPRED=WTTIMEE
BSVRUV1=ETA_BSVRUV1
BSVRUV2=ETA_BSVRUV2
W=exp(BSVRUV1)
if (FLAG == 2) W=exp(BSVRUV2)
if (FLAG == 3) W=IPRED
if (FLAG == 4) W=IPRED
if (W == 0) W=1
IRES=DV - IPRED
IWRES=IRES/W
Y=EPS_RSV_3*W + IPRED
if (FLAG == 2) Y=EPS_RSV_4*W + IPRED
if (FLAG == 3) Y=EPS_RSV_1*W + IPRED
if (FLAG == 4) Y=EPS_RSV_2*W + IPRED

