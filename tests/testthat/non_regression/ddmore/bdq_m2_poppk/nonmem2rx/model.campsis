[MAIN]
TVX0=THETA_X0
TVXSS=THETA_XSS
TVREP=THETA_REP
BSVX0=ETA_BSVX0
BSVXSS=ETA_BSVXSS
BSVREP=ETA_BSVREP
SHPX0=THETA_SHPX0
PHIX0=exp(BSVX0)
PHI2X0=(pow(PHIX0, SHPX0) - 1)/SHPX0
SHPXSS=THETA_SHPXSS
PHIXSS=exp(BSVXSS)
PHI2XSS=(pow(PHIXSS, SHPXSS) - 1)/SHPXSS
X0=TVX0 * exp(PHI2X0)
XSS=TVXSS * exp(PHI2XSS)
REP=TVREP * exp(BSVREP)
HL=log(2)/REP
INIT_A8=X0
TVWT0=THETA_WT0
TVWT120=THETA_WT120
BSVWT0=ETA_BSVWT0
BSVWT120=ETA_BSVWT120
SHPWT120=THETA_SHPWT120
PHIWT120=exp(BSVWT120)
PHI2WT120=(pow(PHIWT120, SHPWT120) - 1)/SHPWT120
WT0=TVWT0 * exp(BSVWT0)
WT120=TVWT120 * exp(PHI2WT120)
SLOPE=(WT120 - WT0)/(120 * 7 * 24)
TVMAT=THETA_MAT
TVFR=THETA_FR
TVCL=THETA_CL
TVV=THETA_V
TVQ1=THETA_Q1
TVVP1=THETA_VP1
TVQ2=THETA_Q2
TVVP2=THETA_VP2
TVCLM2=THETA_CLM2
TVVM2=THETA_VM2
BOVF=ETA_BOVF_1
if (OCC == 2) BOVF=ETA_BOVF_2
BOVMAT=ETA_BOVMAT_1
if (OCC == 2) BOVMAT=ETA_BOVMAT_2
BSVF=ETA_BSVF
BSVCL=ETA_BSVCL
BSVCLM2=ETA_BSVCLM2
BSVV=ETA_BSVV
BSVQ1=ETA_BSVQ1
BSVVM2=ETA_BSVVM2
BLACK=0
if (RACE == 2) BLACK=1
BLACKCL=1 + BLACK * THETA_BLACKCL
AGECL=1 + (32 - AGE) * (THETA_AGECL)
PHI=log(TVMAT/(1 - TVMAT)) + BOVMAT
MAT=6 * exp(PHI)/(exp(PHI) + 1)
FR=TVFR
MTT=MAT * FR
KAHL=MAT * (1 - FR)/3.3
KA=log(2)/KAHL
KTR=2/MTT
F_A1=1.8002 * exp(BOVF + BSVF)
CLB=TVCL * BLACKCL * AGECL * exp(BSVCL)
VB=TVV * exp(BSVV)
Q1B=TVQ1 * exp(BSVQ1)
VP1B=TVVP1
Q2B=TVQ2
VP2B=TVVP2
CLM2B=TVCLM2 * BLACKCL * AGECL * exp(BSVCLM2)
VM2B=TVVM2 * exp(BSVVM2)

[ODE]
d/dt(A_ALBUMIN)=log(2)/(HL * 7 * 24) * A_ALBUMIN * (1 - A_ALBUMIN/XSS)
WTTIME=WT0 + t * SLOPE
ALBRELI=A_ALBUMIN/XSS
COVALBI=pow((ALBRELI), THETA_COVALBI)
FM=pow((ALBRELI), (-THETA_COVALBI))
ALLCL=pow((WTTIME/70), THETA_ALLCL)
ALLV=pow((WTTIME/70), THETA_ALLV)
CL=CLB * COVALBI * ALLCL
V=VB * ALLV
Q1=Q1B * ALLCL
VP1=VP1B * ALLV
Q2=Q2B * ALLCL
VP2=VP2B * ALLV
CLM2=CLM2B/FM * COVALBI * ALLCL
VM2=VM2B/FM * ALLV
d/dt(A_DEPOT)=-KTR * A_DEPOT
d/dt(A_BDQC)=A_TRANSI2 * KA - A_BDQC * CL/V - A_BDQC * Q1/V + A_BDQPERI1 * Q1/VP1 - A_BDQC * Q2/V + A_BDQPERI2 * Q2/VP2
d/dt(A_BDQPERI1)=A_BDQC * Q1/V - A_BDQPERI1 * Q1/VP1
d/dt(A_BDQPERI2)=A_BDQC * Q2/V - A_BDQPERI2 * Q2/VP2
d/dt(A_M2)=A_BDQC * CL/V - A_M2 * CLM2/VM2
d/dt(A_TRANSI1)=A_DEPOT * KTR - A_TRANSI1 * KTR
d/dt(A_TRANSI2)=A_TRANSI1 * KTR - A_TRANSI2 * KA
F=A_DEPOT

[F]
A_DEPOT=F_A1

[INIT]
A_ALBUMIN=INIT_A8

[ERROR]
WTTIMEE=WT0 + TIME * SLOPE
FURELIP=THETA_XSS/A_ALBUMIN
COVFUIP=pow((FURELIP), THETA_COVFUIP)
ALBRELIE=A_ALBUMIN/XSS
FME=pow((ALBRELIE), (-THETA_COVALBI))
ALLCLE=pow((WTTIMEE/70), THETA_ALLCL)
ALLVE=pow((WTTIMEE/70), THETA_ALLV)
VE=VB * ALLVE * COVFUIP
VM2E=VM2B/FME * ALLVE * COVFUIP
DEL=1e-12
IPRED=log(A_BDQC/VE + DEL)
if (FLAG == 2) IPRED=log(A_M2/VM2E + DEL)
if (FLAG == 3) IPRED=A_ALBUMIN
if (FLAG == 4) IPRED=WTTIMEE
BSVRUV1=ETA_BSVRUV1
BSVRUV2=ETA_BSVRUV2
W=1 * exp(BSVRUV1)
if (FLAG == 2) W=1 * exp(BSVRUV2)
if (FLAG == 3) W=IPRED
if (FLAG == 4) W=IPRED
if (W == 0) W=1
IRES=DV - IPRED
IWRES=IRES/W
Y=IPRED + W * EPS_RUV3
if (FLAG == 2) Y=IPRED + W * EPS_RUV4
if (FLAG == 3) Y=IPRED + W * EPS_RUV1
if (FLAG == 4) Y=IPRED + W * EPS_RUV2

