[MAIN]
MERO=0
if (TYPE == 1 || TYPE == 3) MERO=1
COL=0
if (TYPE == 2 || TYPE == 3) COL=1
CONTR=0
if (TYPE == 4 || TYPE == 5) CONTR=1
TVKGA=0
if (BACT == 2) TVKGA=THETA_KGA
TVKGP=0
if (BACT == 1) TVKGP=THETA_KGP
TVKK=THETA_KK
TVEMAX1=0
if (BACT == 2 && COL == 1) TVEMAX1=THETA_EMAX1
TVSLOP1=0
if (BACT == 1 && COL == 1) TVSLOP1=THETA_SLOP1
TVEMAX2=0
if (BACT == 2 && MERO == 1) TVEMAX2=THETA_EMAX2
TVEMAX3=0
if (BACT == 1 && MERO == 1) TVEMAX3=THETA_EMAX3
TVEC51=0
if (BACT == 2 && COL == 1) TVEC51=THETA_EC51
TVSLOPAM=0
if (BACT == 2 && MERO == 1) TVSLOPAM=THETA_SLOPAM
TVEC53=0
if (BACT == 1 && MERO == 1) TVEC53=THETA_EC53
if (COL == 1) TVGAMC=THETA_GAMC
if (BACT == 2 && MERO == 1) TVGAMA=THETA_GAMA
if (BACT == 1 && MERO == 1) TVGAMP=THETA_GAMP
TVBMAX=pow(10, THETA_BMAX)
TVKON51=0
if (BACT == 2 && COL == 1) TVKON51=THETA_KON51
TVKON52=0
if (BACT == 1 && COL == 1) TVKON52=THETA_KON52
TVKOFFC=0
if (COL == 1) TVKOFFC=THETA_KOFFC
if (MERO == 1) TVKOFFM=THETA_KOFFM
TVKONCA=0
if (BACT == 2 && COL == 1) TVKONCA=THETA_KONCA
TVKONCP=0
if (BACT == 1 && COL == 1) TVKONCP=THETA_KONCP
TVKONMA=0
if (BACT == 2 && MERO == 1) TVKONMA=THETA_KONMA
TVKONMP=0
if (BACT == 1 && MERO == 1) TVKONMP=THETA_KONMP
if (COL == 1) TVGAM3C=THETA_GAM3C
if (COL == 1) TVGAM1=THETA_GAM1
KGDXS=1
if (ID2 > 18) KGDXS=THETA_KGDXS + 1
MSLOPAM=TVSLOPAM*pow(THETA_MSLOPAM + 1, -TVGAMA)
EC53M=TVEC53*(THETA_MSLOPAM + 1)
KGAFM=THETA_KGAFM
KGPFM=THETA_KGPFM
KGAM=KGDXS*TVKGA*(1 - KGAFM)
KGPM=KGDXS*TVKGP*(1 - KGPFM)
MUTA=pow(10, -THETA_MUTA)
MUTP=MUTA
MUT=0
if (BACT == 2 && MERO == 1) MUT=MUTA
if (BACT == 1 && MERO == 1) MUT=MUTP
NMUT=0
if (AMT*MUT >= 0) NMUT=AMT*MUT
KGA=KGDXS*TVKGA*exp(ETA_KGA)
KGP=KGDXS*TVKGP*exp(ETA_KGA)
KK=TVKK
EMAX1=TVEMAX1
SLOP1=TVSLOP1
EMAX2=TVEMAX2
EMAX3=TVEMAX3
EC51=TVEC51
SLOPAM=TVSLOPAM
EC53=TVEC53
GAMA=TVGAMA
GAMP=TVGAMP
GAMC=TVGAMC
BMAX=TVBMAX
KON51=TVKON51
KON52=TVKON52
KOFFC=TVKOFFC
KOFFM=TVKOFFM
KONCA=TVKONCA
KONCP=TVKONCP
KONMA=TVKONMA
KONMP=TVKONMP
GAM3C=TVGAM3C
GAM1=TVGAM1
KE1=0.02
KE2=0
if (A_0(6) == 0.041619999999999997 && TIME < 8) KE2=0.058999999999999997
if (A_0(6) == 0.041619999999999997 && TIME >= 8) KE2=0.0030000000000000001
if (A_0(6) == 0.18770000000000001 && TIME < 8) KE2=0.079000000000000001
if (A_0(6) == 0.18770000000000001 && TIME >= 8) KE2=0.021000000000000001
if (A_0(6) == 0.29599999999999999 && TIME < 8) KE2=0.042000000000000003
if (A_0(6) == 0.29599999999999999 && TIME >= 8) KE2=0.042000000000000003
if (A_0(6) == 0.77529999999999999 && TIME < 8) KE2=0.0030000000000000001
if (A_0(6) == 0.77529999999999999 && TIME >= 8) KE2=0.017000000000000001
if (A_0(6) == 2.1819999999999999 && TIME < 8) KE2=0.037999999999999999
if (A_0(6) == 2.1819999999999999 && TIME >= 8) KE2=0.014999999999999999
if (A_0(6) == 4.3049999999999997 && TIME < 8) KE2=0.0076
if (A_0(6) == 4.3049999999999997 && TIME >= 8) KE2=0.00060999999999999997
if (A_0(6) == 12.023999999999999 && TIME < 8) KE2=0.012
if (A_0(6) == 12.023999999999999 && TIME >= 8) KE2=0.0033
if (A_0(6) == 0.080909999999999996 && TIME < 8) KE2=0.16
if (A_0(6) == 0.080909999999999996 && TIME >= 8) KE2=0.039
if (A_0(6) == 0.24829999999999999 && TIME < 8) KE2=0.031
if (A_0(6) == 0.24829999999999999 && TIME >= 8) KE2=0.070000000000000007
if (A_0(6) == 0.95820000000000005 && TIME < 8) KE2=0.049000000000000002
if (A_0(6) == 0.95820000000000005 && TIME >= 8) KE2=0.092999999999999999
if (A_0(6) == 2.6720000000000002 && TIME < 8) KE2=0.036999999999999998
if (A_0(6) == 2.6720000000000002 && TIME >= 8) KE2=0.056000000000000001
if (A_0(6) == 5.1130000000000004 && TIME < 8) KE2=0.027
if (A_0(6) == 5.1130000000000004 && TIME >= 8) KE2=0.021999999999999999
if (A_0(6) == 11.471 && TIME < 8) KE2=0.010999999999999999
if (A_0(6) == 11.471 && TIME >= 8) KE2=0.0057999999999999996
if (A_0(6) == 24.099 && TIME < 8) KE2=0.0077999999999999996
if (A_0(6) == 24.099 && TIME >= 8) KE2=0.0020999999999999999
CA025=0
if (A_0(6) == 0.19500000000000001 || A_0(6) == 0.19900000000000001 || A_0(6) == 0.20499999999999999) CA025=1
CA026=0
if (A_0(6) == 0.187 || A_0(6) == 0.21099999999999999 || A_0(6) == 0.223) CA026=1
if (CA025 == 1 && TIME < 8) KE2=0.19600000000000001
if (CA025 == 1 && TIME >= 8) KE2=0.053400000000000003
if (CA026 == 1 && TIME < 8) KE2=0.19600000000000001
if (CA026 == 1 && TIME >= 8) KE2=0.053400000000000003
if (A_0(6) == 0.43099999999999999 && TIME < 8) KE2=0.111
if (A_0(6) == 0.43099999999999999 && TIME >= 8) KE2=0.126
if (A_0(6) == 0.41099999999999998 && TIME < 8) KE2=0.111
if (A_0(6) == 0.41099999999999998 && TIME >= 8) KE2=0.126
if (A_0(6) == 0.40799999999999997 && TIME < 8) KE2=0.111
if (A_0(6) == 0.40799999999999997 && TIME >= 8) KE2=0.126
if (A_0(6) == 0.48199999999999998 && TIME < 8) KE2=0.111
if (A_0(6) == 0.48199999999999998 && TIME >= 8) KE2=0.126
if (A_0(6) == 0.47899999999999998 && TIME < 8) KE2=0.111
if (A_0(6) == 0.47899999999999998 && TIME >= 8) KE2=0.126
if (A_0(6) == 0.46500000000000002 && TIME < 8) KE2=0.111
if (A_0(6) == 0.46500000000000002 && TIME >= 8) KE2=0.126
if (A_0(6) == 0.67300000000000004 && TIME < 8) KE2=0.050299999999999997
if (A_0(6) == 0.67300000000000004 && TIME >= 8) KE2=0.0143
if (A_0(6) == 0.70999999999999996 && TIME < 8) KE2=0.050299999999999997
if (A_0(6) == 0.70999999999999996 && TIME >= 8) KE2=0.0143
if (A_0(6) == 1.4670000000000001 && TIME < 8) KE2=0.033000000000000002
if (A_0(6) == 1.4670000000000001 && TIME >= 8) KE2=0.036700000000000003
if (A_0(6) == 1.234 && TIME < 8) KE2=0.033000000000000002
if (A_0(6) == 1.234 && TIME >= 8) KE2=0.036700000000000003
if (A_0(6) == 1.4330000000000001 && TIME < 8) KE2=0.033000000000000002
if (A_0(6) == 1.4330000000000001 && TIME >= 8) KE2=0.036700000000000003
if (A_0(6) == 1.657 && TIME < 8) KE2=0.033000000000000002
if (A_0(6) == 1.657 && TIME >= 8) KE2=0.036700000000000003
if (A_0(6) == 1.4179999999999999 && TIME < 8) KE2=0.033000000000000002
if (A_0(6) == 1.4179999999999999 && TIME >= 8) KE2=0.036700000000000003
if (A_0(6) == 3.5230000000000001 && TIME < 8) KE2=0.035099999999999999
if (A_0(6) == 3.5230000000000001 && TIME >= 8) KE2=0.024500000000000001
if (A_0(6) == 3.4470000000000001 && TIME < 8) KE2=0.035099999999999999
if (A_0(6) == 3.4470000000000001 && TIME >= 8) KE2=0.024500000000000001
if (A_0(6) == 3.2879999999999998 && TIME < 8) KE2=0.035099999999999999
if (A_0(6) == 3.2879999999999998 && TIME >= 8) KE2=0.024500000000000001
if (A_0(6) == 3.0310000000000001 && TIME < 8) KE2=0.035099999999999999
if (A_0(6) == 3.0310000000000001 && TIME >= 8) KE2=0.024500000000000001
if (A_0(6) == 7.6689999999999996 && TIME < 8) KE2=0.0022599999999999999
if (A_0(6) == 7.6689999999999996 && TIME >= 8) KE2=0.0001
if (A_0(6) == 6.6219999999999999 && TIME < 8) KE2=0.0022599999999999999
if (A_0(6) == 6.6219999999999999 && TIME >= 8) KE2=0.0001

[ODE]
CA2=A_3
CE2=0
CA1=A_6
CE1=A_7
AT=A_1 + A_10 + A_2 + A_9
COLA=0
if (BACT == 2 && COL == 1) COLA=pow(CA1, GAMC)*EMAX1/(pow(CA1, GAMC) + pow(EC51, GAMC))
COLP=0
if (BACT == 1 && COL == 1) COLP=pow(CA1, GAMC)*SLOP1
MEROA=0
if (BACT == 2 && MERO == 1) MEROA=pow(CA2, GAMA)*SLOPAM
MEROP=0
if (BACT == 1 && MERO == 1) MEROP=pow(CA2, GAMP)*EMAX3/(pow(CA2, GAMP) + pow(EC53, GAMP))
MEROAM=0
if (BACT == 2 && MERO == 1) MEROAM=pow(CA2, GAMA)*MSLOPAM
MEROPM=0
if (BACT == 1 && MERO == 1) MEROPM=pow(CA2, GAMP)*EMAX3/(pow(CA2, GAMP) + pow(EC53M, GAMP))
COLA1=0
if (BACT == 2 && COL == 1) COLA1=COLA*(1 - pow(CE1, GAM1))
COLP1=0
if (BACT == 1 && COL == 1) COLP1=COLP*(1 - pow(CE1, GAM1))
MEROA1=0
if (BACT == 2 && MERO == 1) MEROA1=MEROA*(1 - CE2)
MEROP1=0
if (BACT == 1 && MERO == 1) MEROP1=MEROP*(1 - CE2)
MEROA1M=0
if (BACT == 2 && MERO == 1) MEROA1M=MEROAM*(1 - CE2)
MEROP1M=0
if (BACT == 1 && MERO == 1) MEROP1M=MEROPM*(1 - CE2)
DRUGA=0
if (BACT == 2 && TYPE == 3) DRUGA=COLA1*pow(MEROA1/(COLA1 + MEROA1) + 1, THETA_NA_3) + MEROA1*pow(COLA1/(COLA1 + MEROA1) + 1, THETA_NA_3)
if (BACT == 2 && TYPE == 3) DRUG=DRUGA
if (BACT == 2 && TYPE == 3) ADD=COLA1 + MEROA1
DRUGB=0
if (BACT == 1 && TYPE == 3) DRUGB=COLP1*pow(MEROP1/(COLP1 + MEROP1) + 1, THETA_NA_4) + MEROP1*pow(COLP1/(COLP1 + MEROP1) + 1, THETA_NA_4)
if (BACT == 1 && TYPE == 3) DRUG=DRUGB
if (BACT == 1 && TYPE == 3) ADD=COLP1 + MEROP1
DRUGAM=0
if (BACT == 2 && TYPE == 3) DRUGAM=COLA1*pow(MEROA1M/(COLA1 + MEROA1M) + 1, THETA_NA_3) + MEROA1M*pow(COLA1/(COLA1 + MEROA1M) + 1, THETA_NA_3)
if (BACT == 2 && TYPE == 3) DRUGM=DRUGAM
if (BACT == 2 && TYPE == 3) ADDM=COLA1 + MEROA1M
DRUGBM=0
if (BACT == 1 && TYPE == 3) DRUGBM=COLP1*pow(MEROP1M/(COLP1 + MEROP1M) + 1, THETA_NA_4) + MEROP1M*pow(COLP1/(COLP1 + MEROP1M) + 1, THETA_NA_4)
if (BACT == 1 && TYPE == 3) DRUGM=DRUGBM
if (BACT == 1 && TYPE == 3) ADDM=COLP1 + MEROP1M
FEEDA=0
if (BACT == 2) FEEDA=(KGA - KK)/BMAX
FEEDP=0
if (BACT == 1) FEEDP=(KGP - KK)/BMAX
SRA=0
if (BACT == 2) SRA=AT*FEEDA
SRP=0
if (BACT == 1) SRP=AT*FEEDP
KON1CA=0
if (BACT == 2 && COL == 1) KON1CA=pow(CA1, GAM3C)*KONCA/(pow(CA1, GAM3C) + pow(KON51, GAM3C))
KON1CP=0
if (BACT == 1 && COL == 1) KON1CP=pow(CA1, GAM3C)*KONCP/(pow(CA1, GAM3C) + pow(KON52, GAM3C))
d/dt(A_1)=0
if (BACT == 2 && COL == 1) DADT(1)=A_1*KGA - A_1*SRA - A_1*(COLA1 + KK)
if (BACT == 1 && COL == 1) DADT(1)=A_1*KGP - A_1*SRP - A_1*(COLP1 + KK)
if (BACT == 2 && MERO == 1) DADT(1)=A_1*KGA - A_1*SRA - A_1*(KK + MEROA1)
if (BACT == 1 && MERO == 1) DADT(1)=A_1*KGP - A_1*SRP - A_1*(KK + MEROP1)
if (BACT == 2 && TYPE == 3) DADT(1)=A_1*KGA - A_1*SRA - A_1*(DRUGA + KK)
if (BACT == 1 && TYPE == 3) DADT(1)=A_1*KGP - A_1*SRP - A_1*(DRUGB + KK)
if (BACT == 2 && CONTR == 1) DADT(1)=A_1*KGA - A_1*KK - A_1*SRA
if (BACT == 1 && CONTR == 1) DADT(1)=A_1*KGP - A_1*KK - A_1*SRP
d/dt(A_2)=0
if (BACT == 2) DADT(2)=A_1*SRA - A_2*KK
if (BACT == 1) DADT(2)=A_1*SRP - A_2*KK
d/dt(A_3)=0
if (MERO == 1) DADT(3)=A_3*(-DILMER - KE1)
d/dt(A_4)=0
d/dt(A_5)=0
d/dt(A_6)=0
if (COL == 1) DADT(6)=A_6*(-DILCOL - KE2)
d/dt(A_7)=0
if (BACT == 2 && COL == 1) DADT(7)=-A_7*KOFFC + A_8*KON1CA
if (BACT == 1 && COL == 1) DADT(7)=-A_7*KOFFC + A_8*KON1CP
d/dt(A_8)=0
if (BACT == 2 && COL == 1) DADT(8)=A_7*KOFFC - A_8*KON1CA
if (BACT == 1 && COL == 1) DADT(8)=A_7*KOFFC - A_8*KON1CP
d/dt(A_9)=0
if (BACT == 2 && COL == 1) DADT(9)=A_9*KGAM - A_9*SRA - A_9*(COLA1 + KK)
if (BACT == 1 && COL == 1) DADT(9)=A_9*KGPM - A_9*SRP - A_9*(COLP1 + KK)
if (BACT == 2 && MERO == 1) DADT(9)=A_9*KGAM - A_9*SRA - A_9*(KK + MEROA1M)
if (BACT == 1 && MERO == 1) DADT(9)=A_9*KGPM - A_9*SRP - A_9*(KK + MEROP1M)
if (BACT == 2 && TYPE == 3) DADT(9)=A_9*KGAM - A_9*SRA - A_9*(DRUGAM + KK)
if (BACT == 1 && TYPE == 3) DADT(9)=A_9*KGPM - A_9*SRP - A_9*(DRUGBM + KK)
if (BACT == 2 && CONTR == 1) DADT(9)=A_9*KGAM - A_9*KK - A_9*SRA
if (BACT == 1 && CONTR == 1) DADT(9)=A_9*KGPM - A_9*KK - A_9*SRP
d/dt(A_10)=0
if (BACT == 2) DADT(10)=-A_10*KK + A_9*SRA
if (BACT == 1) DADT(10)=-A_10*KK + A_9*SRP

[INIT]
A_2=0
A_3=CMER
A_4=0
A_5=1
A_6=CCOL
A_7=0
A_8=1
A_9=NMUT
A_10=0

[ERROR]
LLOQ=M_LN10
A1=A_1
A2=A_2
A3=A_3
A4=A_4
A5=A_5
A6=A_6
A7=A_7
A8=A_8
A9=A_9
A10=A_10
ATOT=A1 + A10 + A2 + A9
if (ATOT < 1.0000000000000001e-5) ATOT=1.0000000000000001e-5
IPRED=log(ATOT)
IRES=DV - IPRED
W=sqrt(SIGMA(1) + SIGMA(2))*M_LN10
IWRES=IRES/W
AAA=0
AAB=0
AAC=0
AAD=0
if (REPL == 1) AAA=1
if (REPL == 2) AAB=1
if (REPL == 3) AAC=1
if (REPL == 4) AAD=1
if (BLOQ == 0) F_FLAG=0
if (BLOQ == 0) Y=IPRED + (AAA*EPS_RSV_2 + AAB*EPS(3) + AAC*EPS(4) + AAD*EPS(5) + EPS_RSV_1)*M_LN10
if (BLOQ == 1) DUM=(-IPRED + LLOQ)/W
if (BLOQ == 1) DUM2=(1.0/4.0)*M_SQRT2*erf(DUM) + 1.0/2.0
if (BLOQ == 1) F_FLAG=1
if (BLOQ == 1) Y=DUM2

