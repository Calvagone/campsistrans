[MAIN]
AUC=DOS/CL
BM0S=SBAS
MRTS=SMRT
IMAX1=1
IC50S=SEC5
DPSLOS=SLO
KOUTS=1.0/MRTS
BM03=BAS3
IC503=EC53
KOUT3=1.0/MRT3
if (FLAG == 4 && TIME == 0) OBASE=DV
W1=OBASE*THETA_W1
IBASE=ETA_IBASE*W1 + OBASE
TVKG=(1.0/168.0)*THETA_KG
KG=TVKG*exp(ETA_KG)
TVKSKI=(1.0/168.0)*THETA_KSKI
KSKIT=TVKSKI*exp(ETA_KSKIT)
TVLAM=(1.0/168.0)*THETA_LAM
LAMBDA=TVLAM*exp(ETA_LAMBDA)
TVDRU=(1.0/168.0)*THETA_DRU
KDRUG=TVDRU*exp(ETA_KDRUG)
TVKV3=(1.0/168.0)*THETA_KV3
KVEG3=TVKV3

[ODE]
EFFS=AUC*IMAX1/(AUC + IC50S)
DPS=BM0S*(DPSLOS*t + 1)
KINS=DPS*KOUTS
EFF3=AUC*IMAX1/(AUC + IC503)
KIN3=BM03*KOUT3
d/dt(A_1)=-A_1*KOUTS + KINS*(1 - EFFS)
d/dt(A_2)=-A_2*KOUTS + KINS
d/dt(A_3)=-A_3*KOUT3 + KIN3*(1 - EFF3)
SKIT=KSKIT*(A_1 - A_2)/A_2
VEG3=KVEG3*(A_3 - BM03)/BM03
AUC1=AUC*KDRUG
d/dt(A_4)=A_4*KG - A_4*(AUC1 - SKIT - VEG3)*exp(-LAMBDA*t)

[INIT]
A_1=BM0S
A_2=BM0S
A_3=BM03
A_4=IBASE

[ERROR]
AA1=A_1
AA2=A_2
AA3=A_3
TUM=A_4
STRT=0
if (PLA == 1) STRT=1
if (FLAG == 4) IPRED=A_4
if (FLAG == 4) W=IPRED*THETA_W1
if (FLAG == 4) Y=EPS_RSV_FIX*W + IPRED
if (FLAG == 4) IRES=DV - IPRED
if (FLAG == 4) IWRES=IRES/W

