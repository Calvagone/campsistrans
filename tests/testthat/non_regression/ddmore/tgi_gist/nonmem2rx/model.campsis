[MAIN]
AUC=DOS/CL
BM0S=SBAS
MRTS=SMRT
IMAX1=1
IC50S=SEC5
DPSLOS=SLO
KOUTS=1/MRTS
BM03=BAS3
IC503=EC53
KOUT3=1/MRT3
if (TIME == 0 && FLAG == 4) OBASE=DV
W1=THETA_W1 * OBASE
IBASE=OBASE + ETA_IBASE * W1
TVKG=THETA_KG/24/7
KG=TVKG * exp(ETA_KG)
TVKSKI=THETA_KSKI/24/7
KSKIT=TVKSKI * exp(ETA_KSKIT)
TVLAM=THETA_LAM/24/7
LAMBDA=TVLAM * exp(ETA_LAMBDA)
TVDRU=THETA_DRU/24/7
KDRUG=TVDRU * exp(ETA_KDRUG)
TVKV3=THETA_KV3/24/7
KVEG3=TVKV3
INIT_A1=BM0S
INIT_A2=BM0S
INIT_A3=BM03
INIT_A4=IBASE
EFFS=IMAX1 * AUC/(IC50S + AUC)

[ODE]
DPS=BM0S * (1 + DPSLOS * t)
KINS=DPS * KOUTS
EFF3=IMAX1 * AUC/(IC503 + AUC)
KIN3=BM03 * KOUT3
d/dt(A_rxddta1)=KINS * (1 - EFFS) - KOUTS * A_rxddta1
d/dt(A_rxddta2)=KINS - KOUTS * A_rxddta2
d/dt(A_rxddta3)=KIN3 * (1 - EFF3) - KOUT3 * A_rxddta3
SKIT=((A_rxddta1 - A_rxddta2)/A_rxddta2) * KSKIT
VEG3=((A_rxddta3 - BM03)/BM03) * KVEG3
AUC1=AUC * KDRUG
d/dt(A_rxddta4)=KG * A_rxddta4 - (AUC1 + (-SKIT) + (-VEG3)) * exp(-(LAMBDA * t)) * A_rxddta4
F=A_rxddta1

[INIT]
A_rxddta1=INIT_A1
A_rxddta2=INIT_A2
A_rxddta3=INIT_A3
A_rxddta4=INIT_A4

[ERROR]
AA1=A_rxddta1
AA2=A_rxddta2
AA3=A_rxddta3
TUM=A_rxddta4
STRT=0
if (PLA == 1) STRT=1
if (FLAG == 4) IPRED=A_rxddta4
if (FLAG == 4) W=IPRED * THETA_W1
if (FLAG == 4) Y=IPRED + W * EPS_RUV1
if (FLAG == 4) IRES=DV - IPRED
if (FLAG == 4) IWRES=IRES/W

