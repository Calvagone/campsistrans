[MAIN]
MOLSAP=5 * 25000 * 1000
MOLCPH=340.37 * 1000
THRESH=80
CRCL2=CRCL
if (CRCL > THRESH) CRCL2=THRESH
CRCLEFF=(1 + THETA_CRCLEFF * (CRCL2 - THRESH))
TVCL=CRCLEFF * exp(THETA_CL)
MU_2=log(TVCL)
CL=exp(MU_2 + ETA_CL)
TVV=exp(THETA_V)
MU_3=log(TVV)
V=exp(MU_3 + ETA_V)
TVQ=exp(THETA_Q)
MU_4=log(TVQ)
Q=exp(MU_4 + ETA_Q)
TVV2=exp(THETA_V2)
MU_5=log(TVV2)
V2=exp(MU_5 + ETA_V2)
TVK12=Q/V
K12=TVK12
TVK21=Q/V2
K21=TVK21
K10=CL/V
TVV3=V
V3=TVV3
TVV4=exp(THETA_V4)
MU_10=log(TVV4)
V4=exp(MU_10 + ETA_V4)
TVSAP10=exp(THETA_SAP10)
MU_6=log(TVSAP10)
SAP10=exp(MU_6 + ETA_SAP10)
TVKOUT=exp(THETA_KOUT)
MU_1=log(TVKOUT)
KOUT=exp(MU_1 + ETA_KOUT)
TVKON=exp(THETA_KON)
MU_7=log(TVKON)
KON=exp(MU_7 + ETA_KON)
KD=10 * 10^(-9)
TVKOFF=TVKON * KD
KOFF=TVKOFF
TVKINT=THETA_KINT
MU_8=log(TVKINT)
KINT=exp(MU_8 + ETA_KINT)
TVQ4=exp(THETA_Q4)
MU_9=log(TVQ4)
Q4=exp(MU_9 + ETA_Q4)
TVK34=Q4/V3
K34=TVK34
TVK43=Q4/V4
K43=TVK43
KIN=KOUT * (SAP10 * V3)
AM3=SAP10/MOLSAP
AM4=SAP10/MOLSAP
INIT_A3=AM3
INIT_A4=AM4
F_A1=1
F_A5=THETA_F_A5
TVKSC=exp(THETA_KSC)
MU_11=log(TVKSC)
KSC=exp(MU_11 + ETA_KSC)
scale1=V/(1000)
scale3=1/(1000 * MOLSAP)

[ODE]
A1=A_PERIH1
A3=A_PERIPH2
A2=A_EFFECT
A4=A_PERIPH3
A5=A_SC
A6=A_COMP
C1=A1/(V * MOLCPH)
C3=A3
C3C1=A6
C3C1_STD=C3C1 * MOLCPH * V3
A1F=A1 - C3C1_STD
C3F=C3 - C3C1
C1F=A1F/(V * MOLCPH)
DADT1=-K10 * A1F + KSC * A5 - K12 * A1F + K21 * A2 - KINT * (V * MOLCPH) * C3C1
DADT2=K12 * A1F - K21 * A2
DADT3=KIN/(V3 * MOLSAP) - KOUT * C3F - KINT * C3C1 + K43 * A4 * V4/V3 - K34 * C3F
DADT4=-K43 * A4 + K34 * C3F * V3/V4
DADT5=-KSC * A5
DADT6=KON * C3F * C1F - (KINT) * C3C1
d/dt(A_PERIH1)=DADT1
d/dt(A_EFFECT)=DADT2
d/dt(A_PERIPH2)=DADT3
d/dt(A_PERIPH3)=DADT4
d/dt(A_SC)=DADT5
d/dt(A_COMP)=DADT6
F=A_PERIH1/scale1

[F]
A_PERIH1=F_A1
A_SC=F_A5

[INIT]
A_PERIPH2=INIT_A3
A_PERIPH3=INIT_A4

[ERROR]
ER1=EPS_RUV1
ER2=EPS_RUV2
IPRED=F
W=THETA_W_2
W2=THETA_W2_2
Y1=IPRED * (1 + W * ER1) + W2 * ER2
if (CMT == 1) W=THETA_W_1
if (CMT == 1) W2=THETA_W2_1
if (CMT == 1) Y1=IPRED * (1 + W * ER1) + W2 * ER2
Y=Y1
IRES=DV - IPRED
IWRES=IRES/(IPRED * W)

