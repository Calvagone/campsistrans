[MAIN]
if (newind <= 1) CHLAST=0
MEDIANCL=39.4

[ODE]
if (t == 0) PREVSCOR=0
B01=THETA_B01
B11=THETA_B11
B21=THETA_B21
B02=THETA_B02
B12=THETA_B12
B22=THETA_B22
FPS0=0
if (PREVSCOR == 0) FPS0=1
FPS1=0
if (PREVSCOR == 1 || PREVSCOR == 2) FPS1=1
FPS2=0
if (PREVSCOR >= 3) FPS2=1
B1=FPS0 * B01 + FPS1 * B11 + FPS2 * B21
B2=FPS0 * B02 + FPS1 * B12 + FPS2 * B22
A1=B1
A2=A1 + B2
IIV=ETA_IIV
TVK=THETA_K
K=TVK * exp(ETA_K)
EMAX0=THETA_EMAX0
EMAX1=THETA_EMAX1
EMAX2=THETA_EMAX2
ED50=exp(THETA_ED50_1) * (CL_IND/MEDIANCL)^THETA_ED50_2
EMAX=EMAX0
if (PREVSCOR >= 1) EMAX=EMAX1
TCOV11=THETA_TCOV11
TCOV13=THETA_TCOV13
TCOV17=THETA_TCOV17
COV11=MHHY
COV13=BID
COV17=CMAXM1
MED17=0
ALL1=(COV17 - MED17) * TCOV17
ALL2=COV11 * TCOV11 + COV13 * TCOV13
COV=ALL1 + ALL2
LAMBDA=exp(THETA_LAMBDA)
ALPHA=exp(THETA_ALPHA)
BETA1=THETA_BETA1
d/dt(A_CENTRAL)=-K * A_CENTRAL
d/dt(A_c.CUMHAZ)=LAMBDA * ALPHA * t^(ALPHA - 1) * exp(BETA1 * DOSE)
F=A_CENTRAL
EXPO=A_CENTRAL
EFF=EMAX * EXPO/(EXPO + ED50)
AA1=A1 + IIV + EFF + COV
AA2=A2 + IIV + EFF + COV
AA1M=AA1 - IIV
AA2M=AA2 - IIV
PREV=PREVSCOR
PREVSCOR=DV
PC0=1
PC1=exp(AA1)/(1 + exp(AA1))
PC2=exp(AA2)/(1 + exp(AA2))
P2=PC2
P1=PC1 - PC2
P0=PC0 - PC1
PC0M=1
PC1M=exp(AA1M)/(1 + exp(AA1M))
PC2M=exp(AA2M)/(1 + exp(AA2M))
P2M=PC2M
P1M=PC1M - PC2M
P0M=PC0M - PC1M
NSIM=THETA_NSIM
Y=-1
if (nmdvid == 2 && DV == 0) Y=P0
if (nmdvid == 2 && DV == 1 || DV == 2) Y=P1
if (nmdvid == 2 && DV >= 3) Y=P2
CUMHAZ=A_c.CUMHAZ
CHLAST=CHLAST
if (nmdvid == 5) Y=exp(-CUMHAZ)
if (nmdvid == 5) CHLAST=CUMHAZ

