[MAIN]
CHLAST=0
MEDIANCL=39.399999999999999
PREVSCOR=0
B01=THETA_B01
B11=THETA_B11
B21=THETA_B21
B02=THETA_B02
B12=THETA_B12
B22=THETA_B22
FPS0=0
if (PREVSCOR == 0) FPS0=1
FPS1=0
if (PREVSCOR == 1 || PREVSCOR == 2) FPS1=1
FPS2=0
if (PREVSCOR >= 3) FPS2=1
B1=B01*FPS0 + B11*FPS1 + B21*FPS2
B2=B02*FPS0 + B12*FPS1 + B22*FPS2
A1=B1
A2=A1 + B2
IIV=ETA_IIV
TVK=THETA_K
K=TVK*exp(ETA_K)
EMAX0=THETA_EMAX0
EMAX1=THETA_EMAX1
EMAX2=THETA_EMAX2
ED50=pow(CL_IND/MEDIANCL, THETA_ED50_2)*exp(THETA_ED50_1)
EMAX=EMAX0
if (PREVSCOR >= 1) EMAX=EMAX1
TCOV11=THETA_TCOV11
TCOV13=THETA_TCOV13
TCOV17=THETA_TCOV17
COV11=MHHY
COV13=BID
COV17=CMAXM1
MED17=0
ALL1=TCOV17*(COV17 - MED17)
ALL2=COV11*TCOV11 + COV13*TCOV13
COV=ALL1 + ALL2
LAMBDA=exp(THETA_LAMBDA)
ALPHA=exp(THETA_ALPHA)
BETA1=THETA_BETA1

[ODE]
d/dt(A_1)=-A_1*K
d/dt(A_2)=ALPHA*LAMBDA*pow(t, ALPHA - 1)*exp(BETA1*DOSE)

[ERROR]
CALLFL=0
EXPO=A_1
CALLFL_=0
EFF=EMAX*EXPO/(ED50 + EXPO)
AA1=A1 + COV + EFF + IIV
AA2=A2 + COV + EFF + IIV
AA1M=AA1 - IIV
AA2M=AA2 - IIV
PREV=PREVSCOR
PREVSCOR_=DV
PC0=1
PC1=exp(AA1)/(exp(AA1) + 1)
PC2=exp(AA2)/(exp(AA2) + 1)
P2=PC2
P1=PC1 - PC2
P0=PC0 - PC1
PC0M=1
PC1M=exp(AA1M)/(exp(AA1M) + 1)
PC2M=exp(AA2M)/(exp(AA2M) + 1)
P2M=PC2M
P1M=PC1M - PC2M
P0M=PC0M - PC1M
NSIM=IREP
Y=-1
if (DV == 0 && DVID == 2) Y=P0
if (DV == 1 && DVID == 2 || DV == 2) Y=P1
if (DVID == 2 && DV >= 3) Y=P2
CUMHAZ=A_2
if (DVID == 5) Y=exp(-CUMHAZ)
if (DVID == 5) CHLAST=CUMHAZ
if (DVID == 4) HAZARD=ALPHA*LAMBDA*pow(TIME, ALPHA - 1)*exp(BETA1*DOSE)
if (DVID == 4) Y=HAZARD*exp(-CUMHAZ)

