[MAIN]
BM0=THETA_BM0*exp(ETA_BM0)
MRT=THETA_MRT*exp(ETA_MRT)
IMAX1=THETA_IMAX1
IC50=THETA_IC50*exp(ETA_IC50)
HILL=THETA_HILL
TVSLO=(1.0/1000.0)*THETA_SLO
DPSLO=TVSLO*exp(ETA_DPSLO)
BM02=THETA_BM02*exp(ETA_BM02)
MRT2=THETA_MRT2*exp(ETA_MRT)
IMAX2=THETA_IMAX1
IC502=THETA_IC50*exp(ETA_IC502)
HILL2=THETA_HILL2
BM03=THETA_BM03*exp(ETA_BM03)
MRT3=THETA_MRT3*exp(ETA_MRT)
IMAX3=THETA_IMAX1
IC503=THETA_IC50*exp(ETA_IC503)
BM0S=THETA_BM0S*exp(ETA_BM0S)
MRTS=THETA_MRTS*exp(ETA_MRTS)
IMAXS=THETA_IMAX1
IC50S=THETA_IC50*exp(ETA_IC50S)
TVSLOS=(1.0/1000.0)*THETA_SLO
DPSLOS=TVSLOS*exp(ETA_DPSLOS)
KOUT=1.0/MRT
KOUT2=1.0/MRT2
KOUT3=1.0/MRT3
KOUTS=1.0/MRTS
KIN2=BM02*KOUT2
KIN3=BM03*KOUT3
AUC=DOS/CL
DP1=BM0*(DPSLO*TIME + 1)
DPS=BM0S*(DPSLOS*TIME + 1)

[ODE]
KIN=DP1*KOUT
KINS=DPS*KOUTS
EFF=pow(AUC, HILL)*IMAX1/(pow(AUC, HILL) + pow(IC50, HILL))
EFF2=pow(AUC, HILL2)*IMAX2/(pow(AUC, HILL2) + pow(IC502, HILL2))
EFF3=AUC*IMAX3/(AUC + IC503)
EFFS=AUC*IMAXS/(AUC + IC50S)
d/dt(A_1)=-A_1*KOUT*(1 - EFF) + KIN
d/dt(A_2)=-A_2*KOUT2 + KIN2*(1 - EFF2)
d/dt(A_3)=-A_3*KOUT3 + KIN3*(1 - EFF3)
d/dt(A_4)=-A_4*KOUTS + KINS*(1 - EFFS)

[INIT]
A_1=BM0
A_2=BM02
A_3=BM03
A_4=BM0S

[ERROR]
STRT=0
if (FLAG == 5 && PLA == 0) STRT=1
if (FLAG == 5 && PLA == 1) STRT=2
if (FLAG == 6) STRT=3
if (FLAG == 7) STRT=4
if (FLAG == 8 && PLA == 0) STRT=5
if (FLAG == 8 && PLA == 1) STRT=6
DEL=0
if (A_1 == 0) DEL=1
if (A_2 == 0) DEL=1
if (A_3 == 0) DEL=1
if (A_4 == 0) DEL=1
if (FLAG == 5) IPRED=log(A_1 + DEL)
if (FLAG == 5) W=THETA_W_1
if (FLAG == 5) Y=EPS_RSV_FIX*W + IPRED
if (FLAG == 6) IPRED=log(A_2 + DEL)
if (FLAG == 6) W=sqrt(pow(THETA_W_2, 2) + pow(THETA_W_3, 2)/pow(A_2, 2))
if (FLAG == 6) Y=EPS_RSV_FIX*W + IPRED
if (FLAG == 7) IPRED=log(A_3 + DEL)
if (FLAG == 7) W=THETA_W_4
if (FLAG == 7) Y=EPS_RSV_FIX*W + IPRED
if (FLAG == 8) IPRED=log(A_4 + DEL)
if (FLAG == 8) W=THETA_W_5
if (FLAG == 8) Y=EPS_RSV_FIX*W + IPRED
if (W == 0) W=1
IRES=DV - IPRED
IWRES=IRES/W

