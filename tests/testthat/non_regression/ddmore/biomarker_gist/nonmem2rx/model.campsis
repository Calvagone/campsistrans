[MAIN]
BM0=THETA_BM0 * exp(ETA_BM0)
MRT=THETA_MRT * exp(ETA_MRT)
IMAX1=THETA_IMAX1
IC50=THETA_IC50 * exp(ETA_IC50)
HILL=THETA_HILL
TVSLO=THETA_SLO/1000
DPSLO=TVSLO * exp(ETA_DPSLO)
BM02=THETA_BM02 * exp(ETA_BM02)
MRT2=THETA_MRT2 * exp(ETA_MRT)
IMAX2=THETA_IMAX1
IC502=THETA_IC50 * exp(ETA_IC502)
HILL2=THETA_HILL2
BM03=THETA_BM03 * exp(ETA_BM03)
MRT3=THETA_MRT3 * exp(ETA_MRT)
IMAX3=THETA_IMAX1
IC503=THETA_IC50 * exp(ETA_IC503)
BM0S=THETA_BM0S * exp(ETA_BM0S)
MRTS=THETA_MRTS * exp(ETA_MRTS)
IMAXS=THETA_IMAX1
IC50S=THETA_IC50 * exp(ETA_IC50S)
TVSLOS=THETA_SLO/1000
DPSLOS=TVSLOS * exp(ETA_DPSLOS)
INIT_A1=BM0
INIT_A2=BM02
INIT_A3=BM03
INIT_A4=BM0S
KOUT=1/MRT
KOUT2=1/MRT2
KOUT3=1/MRT3
KOUTS=1/MRTS
KIN2=BM02 * KOUT2
KIN3=BM03 * KOUT3
AUC=DOS/CL

[ODE]
DP1=BM0 * (1 + DPSLO * t)
DPS=BM0S * (1 + DPSLOS * t)
KIN=DP1 * KOUT
KINS=DPS * KOUTS
EFF=IMAX1 * AUC^HILL/(IC50^HILL + AUC^HILL)
EFF2=IMAX2 * AUC^HILL2/(IC502^HILL2 + AUC^HILL2)
EFF3=IMAX3 * AUC/(IC503 + AUC)
EFFS=IMAXS * AUC/(IC50S + AUC)
d/dt(A_COMP1)=KIN - KOUT * (1 - EFF) * A_COMP1
d/dt(A_COMP2)=KIN2 * (1 - EFF2) - KOUT2 * A_COMP2
d/dt(A_COMP3)=KIN3 * (1 - EFF3) - KOUT3 * A_COMP3
d/dt(A_COMP4)=KINS * (1 - EFFS) - KOUTS * A_COMP4
F=A_COMP1
STRT=0
if (FLAG == 5 && PLA == 0) STRT=1
if (FLAG == 5 && PLA == 1) STRT=2
if (FLAG == 6) STRT=3
if (FLAG == 7) STRT=4
if (FLAG == 8 && PLA == 0) STRT=5
if (FLAG == 8 && PLA == 1) STRT=6
DEL=0
if (A_COMP1 == 0) DEL=1
if (A_COMP2 == 0) DEL=1
if (A_COMP3 == 0) DEL=1
if (A_COMP4 == 0) DEL=1
if (FLAG == 5) IPRED=log(A_COMP1 + DEL)
if (FLAG == 5) W=THETA_NA_1
if (FLAG == 5) Y=IPRED + W * eps1
IRES=DV - IPRED
IWRES=IRES/W

[INIT]
A_COMP1=INIT_A1
A_COMP2=INIT_A2
A_COMP3=INIT_A3
A_COMP4=INIT_A4

