[MAIN]
if (nmid <= 30) TVCL=THETA_CL_1
if (nmid > 30) TVCL=THETA_CL_2 * (TBW/104.7)^THETA_CL_3
CL=TVCL * exp(ETA_CL)
F_A1=THETA_F_A1 * exp(ETA_F_A1)
V2=THETA_V2 * exp(ETA_V2)
Q=THETA_Q * exp(ETA_Q)
if (nmid <= 30) TVV3=THETA_V3_1 * (TBW/141.8)^THETA_V3_2
if (nmid > 30) TVV3=THETA_V3_1
V3=TVV3 * exp(ETA_V3)
KA=THETA_KA * exp(ETA_KA)
KTR=KA
scale2=V2
scale3=V3
K14=KA
K45=KTR
K56=KTR
K67=KTR
K78=KTR
K82=KTR
K20=CL/V2
K23=Q/V2
K32=Q/V3

[ODE]
d/dt(A_PODOSE)=-K14 * A_PODOSE
d/dt(A_CENTRAL)=KTR * A_TRANSIT5 - K23 * A_CENTRAL + K32 * A_PERIP - K20 * A_CENTRAL
d/dt(A_PERIP)=K23 * A_CENTRAL - K32 * A_PERIP
d/dt(A_TRANSIT1)=K14 * A_PODOSE - KTR * A_TRANSIT1
d/dt(A_TRANSIT2)=KTR * A_TRANSIT1 - KTR * A_TRANSIT2
d/dt(A_TRANSIT3)=KTR * A_TRANSIT2 - KTR * A_TRANSIT3
d/dt(A_TRANSIT4)=KTR * A_TRANSIT3 - KTR * A_TRANSIT4
d/dt(A_TRANSIT5)=KTR * A_TRANSIT4 - KTR * A_TRANSIT5
F=A_CENTRAL/scale2

[F]
A_PODOSE=F_A1

[ERROR]
IPRED=F
Y=F * (1 + EPS_RUV1)
IRES=DV - IPRED
DEL=0
if (IPRED == 0) DEL=1
IWRES=(1 - DEL) * IRES/(IPRED + DEL)

